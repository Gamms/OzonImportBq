2020-07-31 19:55:41,931 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 19:59:06,809 | bq_method | INFO | Starting uploading data. Record count 100
2020-07-31 19:59:26,201 | bq_method | INFO | Starting job bd0c1924-6994-4683-9d7b-8e2f2c9bb798
2020-07-31 19:59:27,977 | bq_method | INFO | Loading data into the BQ table stock
2020-07-31 20:09:26,488 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 20:09:26,801 | __main__ | ERROR | Ошибка выполнения.
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 93, in main
    el['ozon_id'] = 'ip_shl'
TypeError: 'str' object does not support item assignment
2020-07-31 20:11:17,695 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 20:11:18,027 | __main__ | ERROR | Ошибка выполнения.
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 93, in main
    el['ozon_id'] = 'ip_shl'
TypeError: 'str' object does not support item assignment
2020-07-31 20:11:24,005 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 20:11:46,308 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 20:11:46,546 | bq_method | INFO | Starting uploading data. Record count 100
2020-07-31 20:11:49,066 | bq_method | INFO | Starting job 2ed0cb1b-5117-433c-ba95-d14006a0e295
2020-07-31 20:11:49,066 | bq_method | INFO | Loading data into the BQ table stock
2020-07-31 20:11:49,449 | __main__ | ERROR | Ошибка выполнения.
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 96, in main
    bq_method.export_js_to_bq(items, method,jsonkey,datasetid,LOG_FILE)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\bq_method.py", line 33, in export_js_to_bq
    job.result()  # Waits for table load to complete.
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\cloud\bigquery\job.py", line 812, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\api_core\future\polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Provided Schema does not match Table ferrous-depth-277416:ozon.stock. Cannot add fields (field: dateExport)
2020-07-31 20:13:52,213 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 20:14:35,410 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 20:15:27,100 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 20:51:13,100 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 20:51:48,171 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 20:51:48,268 | __main__ | ERROR | Ошибка выполнения.
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 92, in main
    result = js['result']
KeyError: 'result'
2020-07-31 20:52:07,279 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 20:54:11,633 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 20:54:11,634 | __main__ | ERROR | Ошибка выполнения.
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 87, in main
    data=f'{"page": {page},"page_size": {querycount}}',
ValueError: Invalid format specifier
2020-07-31 20:59:37,096 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 21:00:12,914 | __main__ | ERROR | Ошибка выполнения.
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 94, in main
    totalrecord=result.total
AttributeError: 'dict' object has no attribute 'total'
2020-07-31 21:00:37,042 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 21:00:50,196 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 21:01:50,316 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 21:03:06,310 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 21:03:34,495 | __main__ | ERROR | Ошибка выполнения.
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 106, in main
    itemsnext=jsnext['result']['items']
KeyError: 'result'
2020-07-31 21:04:30,430 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 21:05:15,637 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 21:07:39,562 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 21:07:59,172 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 21:08:52,032 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 21:09:40,563 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 21:10:43,801 | bq_method | INFO | Starting uploading data. Record count 831
2020-07-31 21:10:46,520 | bq_method | INFO | Starting job eb30bbce-977f-4597-a660-b25dcfda8cf0
2020-07-31 21:10:46,521 | bq_method | INFO | Loading data into the BQ table stock
2020-07-31 21:47:48,013 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 21:47:48,014 | __main__ | ERROR | Ошибка выполнения.
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 85, in main
    items=ozon_method.ozon_import(method,apimethods.get('stock'), apikey,LOG_FILE,clientid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 14, in ozon_import
    items = query_stock(apimethods, logers, method, apikey,clientid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 23, in query_stock
    res = make_query(method, apiuri, data, headers, logers)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 52, in make_query
    res = requests.get(uri, data, headers)
TypeError: get() takes from 1 to 2 positional arguments but 3 were given
2020-07-31 21:48:50,763 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 21:48:50,764 | __main__ | ERROR | Ошибка выполнения.
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 85, in main
    items=ozon_method.ozon_import(method,apimethods.get('stock'), apikey,LOG_FILE,clientid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 14, in ozon_import
    items = query_stock(apimethods, logers, method, apikey,clientid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 23, in query_stock
    res = make_query(method, apiuri, data, headers, logers)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 52, in make_query
    res = requests.get(uri, data, headers)
TypeError: get() takes from 1 to 2 positional arguments but 3 were given
2020-07-31 21:49:15,114 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 21:49:15,234 | ozon_method | INFO | Ошибка запроса. Статус ответа:400
2020-07-31 21:49:15,307 | ozon_method | INFO | Ошибка запроса. Статус ответа:400
2020-07-31 21:49:15,380 | ozon_method | INFO | Ошибка запроса. Статус ответа:400
2020-07-31 21:49:15,450 | ozon_method | INFO | Ошибка запроса. Статус ответа:400
2020-07-31 21:49:15,450 | __main__ | ERROR | Ошибка выполнения.
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 85, in main
    items=ozon_method.ozon_import(method,apimethods.get('stock'), apikey,LOG_FILE,clientid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 14, in ozon_import
    items = query_stock(apimethods, logers, method, apikey,clientid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 26, in query_stock
    result = js['result']
KeyError: 'result'
2020-07-31 21:49:51,251 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 21:50:00,159 | ozon_method | INFO | Ошибка запроса. Статус ответа:400
2020-07-31 21:50:41,543 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 21:51:55,201 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 21:52:13,287 | __main__ | ERROR | Ошибка выполнения.
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 85, in main
    items=ozon_method.ozon_import(method,apimethods.get('stock'), apikey,LOG_FILE,clientid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 14, in ozon_import
    items = query_stock(apimethods, logers, method, apikey,clientid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 36, in query_stock
    res = make_query(method, apiuri, data, headers, logers)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 52, in make_query
    res = requests.get(uri, data, headers)
TypeError: get() takes from 1 to 2 positional arguments but 3 were given
2020-07-31 21:53:52,440 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 21:53:52,791 | __main__ | ERROR | Ошибка выполнения.
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 85, in main
    items=ozon_method.ozon_import(method,apimethods.get('stock'), apikey,LOG_FILE,clientid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 14, in ozon_import
    items = query_stock(apimethods, logers, method, apikey,clientid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 36, in query_stock
    res = make_query(method, apiuri, data, headers, logers)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 52, in make_query
    res = requests.get(uri, data, headers)
TypeError: get() takes from 1 to 2 positional arguments but 3 were given
2020-07-31 21:54:33,843 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 22:21:49,074 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 22:22:14,351 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 22:23:40,879 | ozon_method | INFO | Ошибка запроса. Статус ответа:400
2020-07-31 22:23:40,955 | ozon_method | INFO | Ошибка запроса. Статус ответа:400
2020-07-31 22:23:41,038 | ozon_method | INFO | Ошибка запроса. Статус ответа:400
2020-07-31 22:23:41,113 | ozon_method | INFO | Ошибка запроса. Статус ответа:400
2020-07-31 22:24:31,041 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 22:25:55,893 | ozon_method | INFO | Ошибка запроса. Статус ответа:400
2020-07-31 22:25:55,981 | ozon_method | INFO | Ошибка запроса. Статус ответа:400
2020-07-31 22:25:56,070 | ozon_method | INFO | Ошибка запроса. Статус ответа:400
2020-07-31 22:25:56,141 | ozon_method | INFO | Ошибка запроса. Статус ответа:400
2020-07-31 22:27:02,003 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 22:27:39,250 | __main__ | ERROR | Ошибка выполнения.
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 85, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 12, in ozon_import
    items = query(apimethods, logers, apikey, clientid,method)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 26, in query
    items = result['items']
TypeError: list indices must be integers or slices, not str
2020-07-31 22:32:11,728 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 22:41:05,400 | __main__ | ERROR | Ошибка выполнения.
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 85, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 12, in ozon_import
    items = query(apimethods, logers, apikey, clientid,method)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 26, in query
    items = result['items']
TypeError: list indices must be integers or slices, not str
2020-07-31 22:41:23,152 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 22:50:12,246 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 22:52:47,004 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 22:53:04,066 | __main__ | ERROR | Ошибка выполнения.
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 85, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 12, in ozon_import
    items = query(apimethods, logers, apikey, clientid,method)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 39, in query
    items = jsnext['result']
NameError: name 'jsnext' is not defined
2020-07-31 22:53:26,447 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 22:55:53,548 | bq_method | INFO | Starting uploading data. Record count 444
2020-07-31 22:55:56,537 | bq_method | INFO | Starting job fd7c741d-9c04-41b4-8f47-b05ff6e1c9fc
2020-07-31 22:55:56,538 | bq_method | INFO | Loading data into the BQ table transaction
2020-07-31 23:08:38,952 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 23:10:13,043 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 23:14:00,301 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 23:15:26,618 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 23:15:34,314 | ozon_method | INFO | Ошибка запроса. Статус ответа:404
2020-07-31 23:15:34,400 | ozon_method | INFO | Ошибка запроса. Статус ответа:404
2020-07-31 23:15:34,486 | ozon_method | INFO | Ошибка запроса. Статус ответа:404
2020-07-31 23:15:34,558 | ozon_method | INFO | Ошибка запроса. Статус ответа:404
2020-07-31 23:38:53,503 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 23:39:09,750 | ozon_method | INFO | Ошибка запроса. Статус ответа:404
2020-07-31 23:39:09,859 | ozon_method | INFO | Ошибка запроса. Статус ответа:404
2020-07-31 23:39:09,947 | ozon_method | INFO | Ошибка запроса. Статус ответа:404
2020-07-31 23:39:10,041 | ozon_method | INFO | Ошибка запроса. Статус ответа:404
2020-07-31 23:40:40,657 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 23:41:39,105 | __main__ | INFO | Начало импорта из OZON:
2020-07-31 23:42:30,036 | bq_method | INFO | Starting uploading data. Record count 3926
2020-07-31 23:42:34,102 | bq_method | INFO | Starting job 4d0f9a67-2611-4ed6-9de2-7339ec3b8c49
2020-07-31 23:42:34,103 | bq_method | INFO | Loading data into the BQ table orders
