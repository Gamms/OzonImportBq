2020-08-04 00:16:23,496 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 00:17:59,446 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 00:34:41,451 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 00:35:59,131 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 00:46:14,105 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 00:47:41,909 | bq_method | INFO | Starting uploading data. Record count 254
2020-08-04 00:48:02,269 | __main__ | ERROR | Ошибка выполнения.404 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/ferrous-depth-277416/jobs?uploadType=resumable: Not found: Dataset ferrous-depth-277416:OZON
Traceback (most recent call last):
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\cloud\bigquery\client.py", line 1760, in load_table_from_file
    response = self._do_resumable_upload(
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\cloud\bigquery\client.py", line 2085, in _do_resumable_upload
    upload, transport = self._initiate_resumable_upload(
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\cloud\bigquery\client.py", line 2127, in _initiate_resumable_upload
    upload.initiate(
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\resumable_media\requests\upload.py", line 353, in initiate
    self._process_initiate_response(response)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\resumable_media\_upload.py", line 453, in _process_initiate_response
    _helpers.require_status_code(
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\resumable_media\_helpers.py", line 91, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 404, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 90, in main
    bq_method.export_js_to_bq(items, method,jsonkey,datasetid,LOG_FILE)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\bq_method.py", line 29, in export_js_to_bq
    job = bigquery_client.load_table_from_json(js, table_ref, job_config=job_config)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\cloud\bigquery\client.py", line 2057, in load_table_from_json
    return self.load_table_from_file(
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\cloud\bigquery\client.py", line 1768, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.NotFound: 404 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/ferrous-depth-277416/jobs?uploadType=resumable: Not found: Dataset ferrous-depth-277416:OZON
2020-08-04 00:53:33,356 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 01:03:59,673 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 01:05:31,529 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 01:08:01,045 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 01:08:47,415 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 01:09:36,872 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 01:11:13,637 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 01:11:17,371 | bq_method | INFO | Starting uploading data. Record count 254
2020-08-04 01:11:19,635 | bq_method | INFO | Starting job 2fb77282-e489-402b-8f6e-d578660be69b
2020-08-04 01:11:19,636 | bq_method | INFO | Loading data into the BQ table orders
2020-08-04 01:11:20,036 | __main__ | ERROR | Ошибка выполнения.400 Provided Schema does not match Table ferrous-depth-277416:ozon.orders. Cannot add fields (field: price)
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 89, in main
    bq_method.export_js_to_bq(items, method,jsonkey,datasetid,LOG_FILE)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\bq_method.py", line 33, in export_js_to_bq
    job.result()  # Waits for table load to complete.
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\cloud\bigquery\job.py", line 812, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\api_core\future\polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Provided Schema does not match Table ferrous-depth-277416:ozon.orders. Cannot add fields (field: price)
2020-08-04 01:13:34,207 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 01:13:57,397 | bq_method | INFO | Starting uploading data. Record count 254
2020-08-04 01:13:59,804 | bq_method | INFO | Starting job add37157-ab30-477f-a8eb-7868312f0f75
2020-08-04 01:13:59,805 | bq_method | INFO | Loading data into the BQ table orders
2020-08-04 01:50:02,703 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 01:50:52,598 | __main__ | ERROR | Ошибка выполнения.ozon_import() missing 1 required positional argument: 'ozonid'
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 100, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid,ozonid)
TypeError: ozon_import() missing 1 required positional argument: 'ozonid'
2020-08-04 01:51:01,779 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 01:51:07,450 | __main__ | ERROR | Ошибка выполнения.ozon_import() missing 1 required positional argument: 'ozonid'
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 100, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid,ozonid)
TypeError: ozon_import() missing 1 required positional argument: 'ozonid'
2020-08-04 01:51:15,161 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 01:52:38,402 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 01:53:28,174 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 01:54:34,243 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 01:55:05,391 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 01:55:21,291 | __main__ | ERROR | Ошибка выполнения.ozon_import() missing 1 required positional argument: 'ozonid'
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 100, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid,ozonid)
TypeError: ozon_import() missing 1 required positional argument: 'ozonid'
2020-08-04 01:57:21,090 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 01:57:35,101 | __main__ | ERROR | Ошибка выполнения.query() missing 1 required positional argument: 'ozonid'
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 100, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid,dateimport,ozonid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 12, in ozon_import
    items = query(apimethods, logers, apikey, clientid,method,dateimport,ozonid)
TypeError: query() missing 1 required positional argument: 'ozonid'
2020-08-04 01:58:25,167 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 01:58:28,938 | __main__ | ERROR | Ошибка выполнения.makedata() missing 1 required positional argument: 'dateimport'
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 100, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid,dateimport,ozonid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 12, in ozon_import
    items = query(apimethods, logers, apikey, clientid,method,ozonid,dateimport)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 34, in query
    data,querycount = makedata(page, querycount,method)
TypeError: makedata() missing 1 required positional argument: 'dateimport'
2020-08-04 01:59:03,003 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 01:59:29,231 | bq_method | INFO | Starting uploading data. Record count 254
2020-08-04 01:59:31,650 | bq_method | INFO | Starting job 4f8e3ea9-200c-444a-8cee-3f279c277c27
2020-08-04 01:59:31,651 | bq_method | INFO | Loading data into the BQ table orders
2020-08-04 02:00:21,401 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 02:00:25,216 | ozon_method | INFO | Ошибка запроса. Статус ответа:400
2020-08-04 02:00:25,217 | __main__ | ERROR | Ошибка выполнения.'int' object has no attribute 'text'
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 100, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid,dateimport,ozonid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 12, in ozon_import
    items = query(apimethods, logers, apikey, clientid,method,ozonid,dateimport)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 23, in query
    js = json.loads(res.text)
AttributeError: 'int' object has no attribute 'text'
2020-08-04 02:01:26,300 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 02:02:32,741 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 02:03:27,448 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 02:05:25,328 | bq_method | INFO | Starting uploading data. Record count 4201
2020-08-04 02:05:28,690 | bq_method | INFO | Starting job 8a8b5c74-61f2-49d0-8fe8-a5df3f4b2302
2020-08-04 02:05:28,691 | bq_method | INFO | Loading data into the BQ table orders
2020-08-04 02:07:09,921 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 02:08:21,400 | bq_method | INFO | Starting uploading data. Record count 4201
2020-08-04 02:08:24,112 | bq_method | INFO | Starting job 49f59468-7030-4d23-aaa3-9cda3ccf833b
2020-08-04 02:08:24,113 | bq_method | INFO | Loading data into the BQ table orders
2020-08-04 02:11:21,269 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 02:18:55,067 | bq_method | INFO | Starting uploading data. Record count 25754
2020-08-04 02:19:00,949 | bq_method | INFO | Starting job 8948bd69-d15c-4441-990a-ff5cb1cedd1d
2020-08-04 02:19:00,950 | bq_method | INFO | Loading data into the BQ table orders
2020-08-04 02:19:40,887 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 02:19:41,079 | __main__ | ERROR | Ошибка выполнения.name 'ozonid' is not defined
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 105, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid,dateimport,ozonid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 12, in ozon_import
    items = query(apimethods, logers, apikey, clientid,method,ozonid,dateimport)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 60, in query
    el['ozon_id'] = ozonid
NameError: name 'ozonid' is not defined
2020-08-04 02:20:01,785 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 02:20:01,924 | bq_method | INFO | Starting uploading data. Record count 47
2020-08-04 02:20:03,432 | bq_method | INFO | Starting job d47d0be4-7fd1-4ada-a84b-b9a8ad081ae3
2020-08-04 02:20:03,432 | bq_method | INFO | Loading data into the BQ table stock
2020-08-04 02:20:29,720 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 02:20:29,907 | bq_method | INFO | Starting uploading data. Record count 47
2020-08-04 02:20:31,547 | bq_method | INFO | Starting job 0b504c66-96cd-48a2-89a4-f06ee60dc3cb
2020-08-04 02:20:31,547 | bq_method | INFO | Loading data into the BQ table price
2020-08-04 02:20:31,829 | __main__ | ERROR | Ошибка выполнения.400 Provided Schema does not match Table polar-plate-276717:OZON.price. Field price.recommended_price has changed type from FLOAT to STRING
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 106, in main
    bq_method.export_js_to_bq(items, method,jsonkey,datasetid,LOG_FILE)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\bq_method.py", line 33, in export_js_to_bq
    job.result()  # Waits for table load to complete.
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\cloud\bigquery\job.py", line 812, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\api_core\future\polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Provided Schema does not match Table polar-plate-276717:OZON.price. Field price.recommended_price has changed type from FLOAT to STRING
2020-08-04 02:21:02,121 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 02:21:02,432 | bq_method | INFO | Starting uploading data. Record count 47
2020-08-04 02:21:03,933 | bq_method | INFO | Starting job 72096291-85b3-4243-b42a-882180212595
2020-08-04 02:21:03,933 | bq_method | INFO | Loading data into the BQ table price
2020-08-04 02:21:04,956 | __main__ | ERROR | Ошибка выполнения.400 Provided Schema does not match Table polar-plate-276717:OZON.price. Field price.recommended_price has changed type from FLOAT to STRING
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 106, in main
    bq_method.export_js_to_bq(items, method,jsonkey,datasetid,LOG_FILE)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\bq_method.py", line 33, in export_js_to_bq
    job.result()  # Waits for table load to complete.
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\cloud\bigquery\job.py", line 812, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\api_core\future\polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Provided Schema does not match Table polar-plate-276717:OZON.price. Field price.recommended_price has changed type from FLOAT to STRING
2020-08-04 02:21:11,454 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 02:22:44,326 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 02:22:44,506 | bq_method | INFO | Starting uploading data. Record count 47
2020-08-04 02:22:45,929 | bq_method | INFO | Starting job edfa8307-9826-47c7-ae01-453e5ae4f70b
2020-08-04 02:22:45,929 | bq_method | INFO | Loading data into the BQ table price
2020-08-04 02:22:46,243 | __main__ | ERROR | Ошибка выполнения.400 Provided Schema does not match Table polar-plate-276717:OZON.price. Field price.recommended_price has changed type from FLOAT to INTEGER
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 106, in main
    bq_method.export_js_to_bq(items, method,jsonkey,datasetid,LOG_FILE)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\bq_method.py", line 33, in export_js_to_bq
    job.result()  # Waits for table load to complete.
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\cloud\bigquery\job.py", line 812, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\api_core\future\polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Provided Schema does not match Table polar-plate-276717:OZON.price. Field price.recommended_price has changed type from FLOAT to INTEGER
2020-08-04 02:22:59,131 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 02:22:59,339 | bq_method | INFO | Starting uploading data. Record count 47
2020-08-04 02:23:01,058 | bq_method | INFO | Starting job ced11874-94ef-42e6-92db-4baa6f0d7b15
2020-08-04 02:23:01,058 | bq_method | INFO | Loading data into the BQ table price
2020-08-04 02:23:12,798 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 02:23:31,213 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 02:24:04,207 | ozon_method | INFO | Ошибка запроса. Статус ответа:408
2020-08-04 02:24:04,207 | __main__ | ERROR | Ошибка выполнения.'int' object has no attribute 'text'
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 105, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid,dateimport,ozonid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 12, in ozon_import
    items = query(apimethods, logers, apikey, clientid,method,ozonid,dateimport)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 23, in query
    js = json.loads(res.text)
AttributeError: 'int' object has no attribute 'text'
2020-08-04 02:24:41,004 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 02:25:14,333 | ozon_method | INFO | Ошибка запроса. Статус ответа:408
2020-08-04 02:25:14,334 | __main__ | ERROR | Ошибка выполнения.'int' object has no attribute 'text'
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 105, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid,dateimport,ozonid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 12, in ozon_import
    items = query(apimethods, logers, apikey, clientid,method,ozonid,dateimport)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 23, in query
    js = json.loads(res.text)
AttributeError: 'int' object has no attribute 'text'
2020-08-04 02:27:10,306 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 02:28:10,097 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 02:39:05,531 | __main__ | ERROR | Ошибка выполнения.'price'
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 105, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid,dateimport,ozonid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 12, in ozon_import
    items = query(apimethods, logers, apikey, clientid,method,ozonid,dateimport)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 62, in query
    if el['price']['recommended_price']=='':
KeyError: 'price'
2020-08-04 02:40:03,174 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 02:43:42,210 | ozon_method | INFO | Ошибка запроса. Статус ответа:408
2020-08-04 02:43:42,211 | __main__ | ERROR | Ошибка выполнения.'int' object has no attribute 'text'
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 105, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid,dateimport,ozonid)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 12, in ozon_import
    items = query(apimethods, logers, apikey, clientid,method,ozonid,dateimport)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\ozon_method.py", line 36, in query
    js = json.loads(res.text)
AttributeError: 'int' object has no attribute 'text'
2020-08-04 02:47:31,825 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 02:55:20,751 | bq_method | INFO | Starting uploading data. Record count 24112
2020-08-04 02:56:03,318 | bq_method | INFO | Starting job a46237fa-6795-483e-83aa-944b4b34bd5e
2020-08-04 02:56:03,318 | bq_method | INFO | Loading data into the BQ table transaction
2020-08-04 02:56:04,882 | __main__ | ERROR | Ошибка выполнения.400 Provided Schema does not match Table polar-plate-276717:OZON.transaction. Field orderAmount has changed type from INTEGER to FLOAT
Traceback (most recent call last):
  File "C:/Users/Gamm/PycharmProjects/OzonImportBq/main.py", line 106, in main
    bq_method.export_js_to_bq(items, method,jsonkey,datasetid,LOG_FILE)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\bq_method.py", line 33, in export_js_to_bq
    job.result()  # Waits for table load to complete.
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\cloud\bigquery\job.py", line 812, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "C:\Users\Gamm\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\api_core\future\polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Provided Schema does not match Table polar-plate-276717:OZON.transaction. Field orderAmount has changed type from INTEGER to FLOAT
2020-08-04 12:23:23,795 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 14:11:10,674 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 14:11:53,071 | ozon_method | INFO | Timeout code 408, wait 5 sec:https://api-seller.ozon.ru/v2/finance/transaction/list
2020-08-04 14:20:51,329 | bq_method | INFO | Starting uploading data. Record count 24112
2020-08-04 14:20:55,725 | bq_method | INFO | Starting job e63b4faf-8a37-4d52-bee5-74a08321a7cb
2020-08-04 14:20:55,725 | bq_method | INFO | Loading data into the BQ table transaction
2020-08-04 14:20:59,651 | __main__ | ERROR | Ошибка выполнения.400 Provided Schema does not match Table polar-plate-276717:OZON.transaction. Field orderAmount has changed type from INTEGER to FLOAT
Traceback (most recent call last):
  File "C:/Users/mryzhov/PycharmProjects/OzonImportBq/main.py", line 106, in main
    bq_method.export_js_to_bq(items, method,jsonkey,datasetid,LOG_FILE)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\bq_method.py", line 33, in export_js_to_bq
    job.result()  # Waits for table load to complete.
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\cloud\bigquery\job.py", line 812, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\api_core\future\polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Provided Schema does not match Table polar-plate-276717:OZON.transaction. Field orderAmount has changed type from INTEGER to FLOAT
2020-08-04 14:22:50,975 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 14:28:32,179 | bq_method | INFO | Starting uploading data. Record count 24112
2020-08-04 14:28:36,117 | bq_method | INFO | Starting job 8d83d9f2-4579-4aec-8579-6c2103952d25
2020-08-04 14:28:36,117 | bq_method | INFO | Loading data into the BQ table transaction
2020-08-04 14:28:37,067 | __main__ | ERROR | Ошибка выполнения.400 Provided Schema does not match Table polar-plate-276717:OZON.transaction. Field orderAmount has changed type from INTEGER to FLOAT
Traceback (most recent call last):
  File "C:/Users/mryzhov/PycharmProjects/OzonImportBq/main.py", line 106, in main
    bq_method.export_js_to_bq(items, method,jsonkey,datasetid,LOG_FILE)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\bq_method.py", line 33, in export_js_to_bq
    job.result()  # Waits for table load to complete.
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\cloud\bigquery\job.py", line 812, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\api_core\future\polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Provided Schema does not match Table polar-plate-276717:OZON.transaction. Field orderAmount has changed type from INTEGER to FLOAT
2020-08-04 14:38:10,478 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 16:11:55,277 | __main__ | INFO | Начало импорта из OZON:
2020-08-04 16:19:00,903 | ozon_method | INFO | Timeout code 408, wait 5 sec:https://api-seller.ozon.ru/v2/finance/transaction/list
2020-08-04 16:50:14,581 | ozon_method | INFO | Timeout code 408, wait 5 sec:https://api-seller.ozon.ru/v2/finance/transaction/list
2020-08-04 16:59:17,116 | bq_method | INFO | Starting uploading data. Record count 24113
2020-08-04 16:59:21,470 | bq_method | INFO | Starting job 2e21da7a-986d-46c7-8f43-c90da3c6b655
2020-08-04 16:59:21,470 | bq_method | INFO | Loading data into the BQ table transaction
2021-09-21 15:29:48,995 | __main__ | INFO | Начало импорта из OZON:
2021-09-21 15:30:39,180 | __main__ | INFO | Начало импорта из OZON:
2021-09-21 15:30:40,303 | ozon_method | INFO | Ошибка запроса. Статус ответа:401
2021-09-21 15:30:40,303 | __main__ | ERROR | Ошибка выполнения.'int' object has no attribute 'text'
Traceback (most recent call last):
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\main.py", line 105, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid,dateimport,ozonid)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\ozon_method.py", line 12, in ozon_import
    items = query(apimethods, logers, apikey, clientid,method,ozonid,dateimport)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\ozon_method.py", line 23, in query
    js = json.loads(res.text)
AttributeError: 'int' object has no attribute 'text'
2021-09-21 15:31:23,966 | __main__ | INFO | Начало импорта из OZON:
2021-09-21 15:31:25,148 | ozon_method | INFO | Ошибка запроса. Статус ответа:401
2021-09-21 15:31:25,149 | __main__ | ERROR | Ошибка выполнения.'int' object has no attribute 'text'
Traceback (most recent call last):
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\main.py", line 105, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid,dateimport,ozonid)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\ozon_method.py", line 12, in ozon_import
    items = query(apimethods, logers, apikey, clientid,method,ozonid,dateimport)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\ozon_method.py", line 23, in query
    js = json.loads(res.text)
AttributeError: 'int' object has no attribute 'text'
2021-09-21 15:31:37,291 | __main__ | INFO | Начало импорта из OZON:
2021-09-21 15:31:38,514 | ozon_method | INFO | Ошибка запроса. Статус ответа:401
2021-09-21 15:32:27,793 | __main__ | ERROR | Ошибка выполнения.'int' object has no attribute 'text'
Traceback (most recent call last):
  File "C:/Users/mryzhov/PycharmProjects/OzonImportBq/main.py", line 105, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid,dateimport,ozonid)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\ozon_method.py", line 12, in ozon_import
    items = query(apimethods, logers, apikey, clientid,method,ozonid,dateimport)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\ozon_method.py", line 23, in query
    js = json.loads(res.text)
AttributeError: 'int' object has no attribute 'text'
2021-09-21 15:32:33,531 | __main__ | INFO | Начало импорта из OZON:
2021-09-21 15:32:34,904 | ozon_method | INFO | Ошибка запроса. Статус ответа:401
2021-09-21 15:32:34,905 | __main__ | ERROR | Ошибка выполнения.'int' object has no attribute 'text'
Traceback (most recent call last):
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\main.py", line 105, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid,dateimport,ozonid)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\ozon_method.py", line 12, in ozon_import
    items = query(apimethods, logers, apikey, clientid,method,ozonid,dateimport)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\ozon_method.py", line 23, in query
    js = json.loads(res.text)
AttributeError: 'int' object has no attribute 'text'
2021-09-21 15:32:43,104 | __main__ | INFO | Начало импорта из OZON:
2021-09-21 15:36:36,677 | __main__ | INFO | Начало импорта из OZON:
2021-09-21 15:36:41,868 | ozon_method | INFO | Ошибка запроса. Статус ответа:403
2021-09-21 15:37:05,368 | __main__ | ERROR | Ошибка выполнения.'int' object has no attribute 'text'
Traceback (most recent call last):
  File "C:/Users/mryzhov/PycharmProjects/OzonImportBq/main.py", line 105, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid,dateimport,ozonid)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\ozon_method.py", line 12, in ozon_import
    items = query(apimethods, logers, apikey, clientid,method,ozonid,dateimport)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\ozon_method.py", line 23, in query
    js = json.loads(res.text)
AttributeError: 'int' object has no attribute 'text'
2021-09-21 15:37:20,219 | __main__ | INFO | Начало импорта из OZON:
2021-09-21 15:39:31,153 | __main__ | INFO | Начало импорта из OZON:
2021-09-21 15:46:25,566 | ozon_method | INFO | Ошибка запроса. Статус ответа:504
2021-09-21 15:46:48,052 | __main__ | ERROR | Ошибка выполнения.'int' object has no attribute 'text'
Traceback (most recent call last):
  File "C:/Users/mryzhov/PycharmProjects/OzonImportBq/main.py", line 105, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid,dateimport,ozonid)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\ozon_method.py", line 12, in ozon_import
    items = query(apimethods, logers, apikey, clientid,method,ozonid,dateimport)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\ozon_method.py", line 23, in query
    js = json.loads(res.text)
AttributeError: 'int' object has no attribute 'text'
2021-09-21 15:49:55,253 | __main__ | INFO | Начало импорта из OZON:
2021-09-21 16:00:31,690 | __main__ | ERROR | Ошибка выполнения.'orderAmount'
Traceback (most recent call last):
  File "C:/Users/mryzhov/PycharmProjects/OzonImportBq/main.py", line 105, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid,dateimport,ozonid)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\ozon_method.py", line 12, in ozon_import
    items = query(apimethods, logers, apikey, clientid,method,ozonid,dateimport)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\ozon_method.py", line 66, in query
    if type(el['orderAmount']) is float:
KeyError: 'orderAmount'
2021-09-21 16:06:14,030 | __main__ | INFO | Начало импорта из OZON:
2021-09-21 16:12:17,700 | bq_method | INFO | Starting uploading data. Record count 11140
2021-09-21 16:12:21,400 | bq_method | INFO | Starting job 299a369f-5bd2-4e99-ac93-912442aff47c
2021-09-21 16:12:21,401 | bq_method | INFO | Loading data into the BQ table transaction
2021-09-21 16:12:23,473 | __main__ | ERROR | Ошибка выполнения.400 Provided Schema does not match Table polar-plate-276717:OZON.transaction. Cannot add fields (field: item_return_amount)
Traceback (most recent call last):
  File "C:/Users/mryzhov/PycharmProjects/OzonImportBq/main.py", line 106, in main
    bq_method.export_js_to_bq(items, method,jsonkey,datasetid,LOG_FILE)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\bq_method.py", line 33, in export_js_to_bq
    job.result()  # Waits for table load to complete.
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\cloud\bigquery\job.py", line 812, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\venv\lib\site-packages\google\api_core\future\polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Provided Schema does not match Table polar-plate-276717:OZON.transaction. Cannot add fields (field: item_return_amount)
2021-09-21 16:31:59,798 | __main__ | INFO | Начало импорта из OZON:
2021-09-21 16:35:31,508 | bq_method | INFO | Starting uploading data. Record count 11140
2021-09-21 16:35:34,109 | bq_method | INFO | Starting job 182c9fde-e70c-4103-b3c2-b0f82ef0d4bc
2021-09-21 16:35:34,109 | bq_method | INFO | Loading data into the BQ table trans2021
2021-09-21 16:42:30,428 | __main__ | INFO | Начало импорта из OZON:
2021-09-21 16:42:32,174 | bq_method | INFO | Starting uploading data. Record count 18
2021-09-21 16:42:33,339 | bq_method | INFO | Starting job f66c4907-c304-4ffc-b03e-062ed245f3fd
2021-09-21 16:42:33,340 | bq_method | INFO | Loading data into the BQ table trans2021
2021-09-21 16:45:37,769 | __main__ | INFO | Начало импорта из OZON:
2021-09-21 16:47:57,850 | bq_method | INFO | Starting uploading data. Record count 8314
2021-09-21 16:48:00,190 | bq_method | INFO | Starting job 8b688e77-54a8-420b-abc7-8880d80a9859
2021-09-21 16:48:00,190 | bq_method | INFO | Loading data into the BQ table trans2021
2021-09-21 17:18:33,184 | __main__ | INFO | Начало импорта из OZON:
2021-09-21 17:18:33,193 | __main__ | ERROR | Ошибка выполнения.local variable 'data' referenced before assignment
Traceback (most recent call last):
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\main.py", line 113, in main
    items=ozon_method.ozon_import(method,apimethods.get(method), apikey,LOG_FILE,clientid,dateimport,ozonid)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\ozon_method.py", line 12, in ozon_import
    items = query(apimethods, logers, apikey, clientid,method,ozonid,dateimport)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\ozon_method.py", line 20, in query
    data,querycount = makedata(page, querycount,method,dateimport)
  File "C:\Users\mryzhov\PycharmProjects\OzonImportBq\ozon_method.py", line 91, in makedata
    return data,querycount
UnboundLocalError: local variable 'data' referenced before assignment
2021-09-21 17:19:29,099 | __main__ | INFO | Начало импорта из OZON:
2021-09-21 17:21:22,596 | bq_method | INFO | Starting uploading data. Record count 5389
2021-09-21 17:21:24,677 | bq_method | INFO | Starting job bccb3a8b-9ab3-4e68-ac4b-fba2a3f1ae88
2021-09-21 17:21:24,677 | bq_method | INFO | Loading data into the BQ table order2021
2021-09-21 17:23:13,589 | __main__ | INFO | Начало импорта из OZON:
2021-09-21 17:23:14,689 | bq_method | INFO | Starting uploading data. Record count 39
2021-09-21 17:23:16,071 | bq_method | INFO | Starting job e63938e6-ed9a-47d8-b7b5-5b4db9523afd
2021-09-21 17:23:16,072 | bq_method | INFO | Loading data into the BQ table orders2021
2021-09-21 17:23:33,212 | __main__ | INFO | Начало импорта из OZON:
